# Домашнее задание к занятию "12.9 Базы данных в облаке" - `Андрей Сотников`

---

### Задание 1

<details> <summary>Задание</summary>

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

</details>

> Ответьте на следующие вопросы:
>
> - Какие сетевые службы в ней разрешены?
> - Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
| PORT | STATE | SERVICE | VERSION |   EXPLOIT |
|   ---     |   ---     |   ---     |   ---     |   ---     |
| 21/tcp | open | ftp | vsftpd 2.3.4 | https://www.exploit-db.com/exploits/49757 |
| 22/tcp | open | ssh | OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) |
| 23/tcp | open | telnet | Linux telnetd |
| 25/tcp | open | smtp | Postfix smtpd |
| 53/tcp | open | domain | ISC BIND 9.4.2 | https://www.exploit-db.com/exploits/37721 |
| 80/tcp | open | http | Apache httpd 2.2.8 ((Ubuntu) DAV/2) |
| 111/tcp | open | rpcbind | 2 (RPC #100000) |
| 139/tcp | open | netbios-ssn |   Samba smbd 3.X - 4.X (workgroup: WORKGROUP) |
| 445/tcp | open | netbios-ssn |   Samba smbd 3.X - 4.X (workgroup: WORKGROUP) |
| 512/tcp | open | exec | netkit-rsh rexecd |
| 513/tcp | open | login |   |
| 514/tcp | open | tcpwrapped |   |
| 1099/tcp | open | java-rmi | GNU Classpath grmiregistry |
| 1524/tcp | open | bindshell | Metasploitable root shell |
| 2049/tcp | open | nfs | 2-4 (RPC #100003) |
| 2121/tcp | open | ftp | ProFTPD 1.3.1 | https://www.exploit-db.com/exploits/15449 |
| 3306/tcp | open | mysql | MySQL 5.0.51a-3ubuntu5 | https://www.exploit-db.com/exploits/29724 |
| 5432/tcp | open | postgresql | PostgreSQL DB 8.3.0 - 8.3.7 |
| 5900/tcp | open | vnc | VNC (protocol 3.3) |
| 6000/tcp | open | X11 | (access denied) |
| 6667/tcp | open | irc | UnrealIRCd |
| 8009/tcp | open | ajp13 | Apache Jserv (Protocol v1.3) |
| 8180/tcp | open | http | Apache Tomcat/Coyote JSP engine 1.1 | https://www.exploit-db.com/exploits/12343 |


### Задание 2

> Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.
>
> Запишите сеансы сканирования в Wireshark.
>
> Ответьте на следующие вопросы:
>
> - Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
> - Как отвечает сервер?

1. Режим SYN - хост пытается инициировать TCP-соединение с целевой машиной, используя флаг SYN. Если порт закрыт, машина отвечает с флагами RST и ACK, то есть, разрывает соединение. С открытых же портов приходит пакет с флагами SYN и ACK. Таким образом, сервер подтверждает, что готов установить TCP-соединение.
2. Режим FIN - хост посылает на целевую машину TCP-пакет с флагом FIN. Если порт закрыт, в ответ приходит пакет с флагами RST и ACK (разрыв соединения). Если же порт открыт, в ответ не придет ничего (так как в запросе не установлены флаги SYN, ACK или RST). В этом случае `nmap` посылает еще один FIN-пакет в тот же порт, но с другого порта хоста, вероятно, для проверки, что ответный пакет не потерялся. В этом режиме невозможно определить, открыт ли порт или фильтруется фаерволлом, только если в ответ не приходит ICMP-пакет ***"Destination Unreachable"***
3. Режим Xmas очень похож на FIN, только вместо одного флага в запросе устанавливаются сразу три - FIN, PSH, URG. Пакет начинает светиться, как рождественская елка, отсюда и название =)
4. UDP-режим предназначен для сканирования портов, принимающих UDP-соединения. В этом режиме в нужный порт отправляется UDP-датаграмма. Если я правильно понял, то для известных сервисов датаграмма содержит "полезную нагрузку" для этого сервиса (например, для проверки 53 порта посылается датаграмма, содержащая в себе DNS-запрос), а для пользовательских портов посылается пустая датаграмма. Так как UDP-соединения не имеют механизма подтверждения установки соединения, состояние порта определяется либо по ответному ICMP-пакету ***"Destination unreachable (Port unreachable)"*** (порт закрыт), либо по ответу от сервиса, прослушающего порт (например, служба DNS на 53 порту посылает ответ на ранее отправленный запрос). Если ответа нет, посылается повторная датаграмма. При отсутствии ответа и после этого, порт помечается как открытый | фильтрующийся. Поэтому такое сканирование занимает довольно много времени, в добавок, количество отправляемых ICMP-сообщений может быть ограничено со стороны целевой машины (при ограничении на 1 сообщение в секунду, сканирование всех 65536 портов займет больше 18 часов).
